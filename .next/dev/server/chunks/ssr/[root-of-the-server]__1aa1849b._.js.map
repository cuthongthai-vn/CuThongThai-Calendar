{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 14, "column": 0}, "map": {"version":3,"sources":["file:///Users/bachpham/Documents/CuThongThai_Calendar/components/MacroChart.js/__nextjs-internal-proxy.mjs"],"sourcesContent":["// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport default registerClientReference(\n    function() { throw new Error(\"Attempted to call the default export of [project]/components/MacroChart.js <module evaluation> from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/components/MacroChart.js <module evaluation>\",\n    \"default\",\n);\n"],"names":[],"mappings":";;;;AAAA,uEAAuE;AACvE;;uCACe,IAAA,wQAAuB,EAClC;IAAa,MAAM,IAAI,MAAM;AAA4R,GACzT,0DACA","ignoreList":[0]}},
    {"offset": {"line": 28, "column": 0}, "map": {"version":3,"sources":["file:///Users/bachpham/Documents/CuThongThai_Calendar/components/MacroChart.js/__nextjs-internal-proxy.mjs"],"sourcesContent":["// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport default registerClientReference(\n    function() { throw new Error(\"Attempted to call the default export of [project]/components/MacroChart.js from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/components/MacroChart.js\",\n    \"default\",\n);\n"],"names":[],"mappings":";;;;AAAA,uEAAuE;AACvE;;uCACe,IAAA,wQAAuB,EAClC;IAAa,MAAM,IAAI,MAAM;AAAwQ,GACrS,sCACA","ignoreList":[0]}},
    {"offset": {"line": 42, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":""}},
    {"offset": {"line": 50, "column": 0}, "map": {"version":3,"sources":["file:///Users/bachpham/Documents/CuThongThai_Calendar/components/MacroHeader.js/__nextjs-internal-proxy.mjs"],"sourcesContent":["// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport default registerClientReference(\n    function() { throw new Error(\"Attempted to call the default export of [project]/components/MacroHeader.js <module evaluation> from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/components/MacroHeader.js <module evaluation>\",\n    \"default\",\n);\n"],"names":[],"mappings":";;;;AAAA,uEAAuE;AACvE;;uCACe,IAAA,wQAAuB,EAClC;IAAa,MAAM,IAAI,MAAM;AAA6R,GAC1T,2DACA","ignoreList":[0]}},
    {"offset": {"line": 64, "column": 0}, "map": {"version":3,"sources":["file:///Users/bachpham/Documents/CuThongThai_Calendar/components/MacroHeader.js/__nextjs-internal-proxy.mjs"],"sourcesContent":["// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport default registerClientReference(\n    function() { throw new Error(\"Attempted to call the default export of [project]/components/MacroHeader.js from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/components/MacroHeader.js\",\n    \"default\",\n);\n"],"names":[],"mappings":";;;;AAAA,uEAAuE;AACvE;;uCACe,IAAA,wQAAuB,EAClC;IAAa,MAAM,IAAI,MAAM;AAAyQ,GACtS,uCACA","ignoreList":[0]}},
    {"offset": {"line": 78, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":""}},
    {"offset": {"line": 86, "column": 0}, "map": {"version":3,"sources":["file:///Users/bachpham/Documents/CuThongThai_Calendar/app/macro/page.js"],"sourcesContent":["import { createClient } from '@supabase/supabase-js';\nimport MacroChart from '../../components/MacroChart';\nimport MacroHeader from '../../components/MacroHeader';\n\nexport const dynamic = 'force-dynamic'; // Disable caching to fetch fresh data on every request\n\nconst supabase = createClient(\n    process.env.SUPABASE_URL,\n    process.env.SUPABASE_KEY\n);\n\n// Helper to pivot data: { '2024-01-01': { date: '...', USD: 25000, ... } }\nconst pivotData = (rows) => {\n    const map = {};\n    rows.forEach(r => {\n        // Normalize date to YYYY-MM-DD\n        const dateStr = r.date.split('T')[0];\n        if (!map[dateStr]) map[dateStr] = { date: dateStr };\n\n        // Map indicator keys to simplified props\n        if (r.indicator_key === 'USDVND_OFFICIAL') map[dateStr].official = Number(r.value);\n        if (r.indicator_key === 'USDVND_BLACK_MARKET') map[dateStr].black_market = Number(r.value);\n        if (r.indicator_key === 'VN_GDP_YOY') map[dateStr].gdp = Number(r.value);\n        if (r.indicator_key === 'VN_GDP_ABS_BUSD') map[dateStr].gdp_abs = Number(r.value);\n        if (r.indicator_key === 'VN_CPI_YOY') map[dateStr].cpi = Number(r.value);\n        if (r.indicator_key === 'VN_INTEREST_RATE') map[dateStr].ref_rate = Number(r.value);\n        if (r.indicator_key === 'VN_SAVINGS_RATE_12M') map[dateStr].savings_rate = Number(r.value);\n    });\n    // Convert to sorted array\n    return Object.values(map).sort((a, b) => new Date(a.date) - new Date(b.date));\n};\n\nexport default async function MacroPage() {\n    // Robust Fetching Strategy: Loop to bypass 1000-row API limits\n    let allRows = [];\n    let from = 0;\n    const step = 1000;\n    let keepFetching = true;\n\n    while (keepFetching) {\n        const { data, error } = await supabase\n            .from('macro_indicators')\n            .select('*')\n            .order('date', { ascending: true })\n            .range(from, from + step - 1);\n\n        if (error) {\n            console.error('Error loading data chunk:', error.message);\n            return <div className=\"text-red-500 p-10\">Error loading data: {error.message}</div>;\n        }\n\n        if (data && data.length > 0) {\n            allRows = [...allRows, ...data];\n            from += step;\n            // If we got fewer than 'step', we are done\n            if (data.length < step) {\n                keepFetching = false;\n            }\n        } else {\n            keepFetching = false;\n        }\n    }\n\n    // Alias for compatibility with existing code\n    const rawData = allRows;\n    console.log(`[MacroPage] Total Raw Rows Fetched: ${rawData.length}`);\n\n    const chartData = pivotData(rawData);\n    console.log(`[MacroPage] Loaded ${chartData.length} rows`);\n    if (chartData.length > 0) {\n        console.log(`[MacroPage] First Date: ${chartData[0].date}`);\n        console.log(`[MacroPage] Last Date: ${chartData[chartData.length - 1].date}`);\n        console.log(`[MacroPage] Last Item:`, JSON.stringify(chartData[chartData.length - 1]));\n    }\n\n    // Filter subsets for specific charts\n\n    // 1. Forex: Filter out days where NO forex data exists at all\n    // Pass FULL history, MacroChart handles time-range slicing now.\n    const forexData = chartData.filter(d => d.official || d.black_market);\n\n    // 2. GDP Growth & CPI\n    const econData = chartData.filter(d => d.gdp !== undefined || d.cpi !== undefined);\n\n    // 3. GDP Absolute (Billion USD)\n    const gdpAbsData = chartData.filter(d => d.gdp_abs !== undefined);\n\n    // 4. Interest Rates\n    const ratesData = chartData.filter(d => d.ref_rate !== undefined || d.savings_rate !== undefined);\n\n\n    return (\n        <div className=\"min-h-screen bg-slate-950 p-6 md:p-10\">\n            <MacroHeader />\n\n            <div className=\"grid grid-cols-1 gap-8 max-w-7xl mx-auto\">\n\n                {/* SECTION 1: EXCHANGE RATE */}\n                <section>\n                    <div className=\"flex items-center justify-between mb-4\">\n                        <h2 className=\"text-xl font-bold text-white flex items-center\">\n                            <span className=\"bg-green-500 w-1 h-6 mr-3 rounded-full\"></span>\n                            Tỷ Giá USD/VND\n                        </h2>\n                    </div>\n                    <MacroChart\n                        data={forexData}\n                        dataKeys={[\n                            { key: 'black_market', color: '#fbbf24', name: 'Chợ Đen' },\n                            { key: 'official', color: '#3b82f6', name: 'Ngân Hàng' }\n                        ]}\n                        height={400}\n                    />\n                    <div className=\"text-xs text-slate-500 mt-2 text-right\">** Nguồn: GSO, WB, IMF và Tổng hợp</div>\n                </section>\n\n                <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-8\">\n\n                    {/* SECTION 2: INTEREST RATES */}\n                    <section>\n                        <div className=\"flex items-center justify-between mb-4\">\n                            <h2 className=\"text-xl font-bold text-white flex items-center\">\n                                <span className=\"bg-purple-500 w-1 h-6 mr-3 rounded-full\"></span>\n                                Lãi Suất (%)\n                            </h2>\n                        </div>\n                        <MacroChart\n                            data={ratesData}\n                            dataKeys={[\n                                { key: 'ref_rate', color: '#a855f7', name: 'Điều hành (SBV)' },\n                                { key: 'savings_rate', color: '#ec4899', name: 'Tiết kiệm 12T' }\n                            ]}\n                        />\n                    </section>\n\n                    {/* SECTION 3: GDP SIZE (ABSOLUTE) */}\n                    <section>\n                        <div className=\"flex items-center justify-between mb-4\">\n                            <h2 className=\"text-xl font-bold text-white flex items-center\">\n                                <span className=\"bg-emerald-500 w-1 h-6 mr-3 rounded-full\"></span>\n                                Quy Mô GDP (Tỷ USD)\n                            </h2>\n                        </div>\n                        <MacroChart\n                            data={gdpAbsData}\n                            dataKeys={[\n                                { key: 'gdp_abs', color: '#10b981', name: 'GDP (Tỷ $)', unit: 'B$' }\n                            ]}\n                        />\n                    </section>\n\n                    {/* SECTION 4: GDP GROWTH & INFLATION */}\n                    <section className=\"lg:col-span-2\">\n                        <div className=\"flex items-center justify-between mb-4\">\n                            <h2 className=\"text-xl font-bold text-white flex items-center\">\n                                <span className=\"bg-cyan-500 w-1 h-6 mr-3 rounded-full\"></span>\n                                Tăng Trưởng & Lạm Phát (%)\n                            </h2>\n                        </div>\n                        <MacroChart\n                            data={econData}\n                            dataKeys={[\n                                { key: 'gdp', color: '#06b6d4', name: 'GDP (YoY)' },\n                                { key: 'cpi', color: '#f97316', name: 'CPI (Lạm phát)' }\n                            ]}\n                        />\n                    </section>\n                </div>\n            </div>\n            <FloatingCTA />\n        </div>\n    );\n}\n"],"names":[],"mappings":"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"}}]
}