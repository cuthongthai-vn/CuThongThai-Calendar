{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 14, "column": 0}, "map": {"version":3,"sources":["file:///Users/bachpham/Documents/CuThongThai_Calendar/app/assets/AssetsDashboard.js/__nextjs-internal-proxy.mjs"],"sourcesContent":["// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport default registerClientReference(\n    function() { throw new Error(\"Attempted to call the default export of [project]/app/assets/AssetsDashboard.js <module evaluation> from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/app/assets/AssetsDashboard.js <module evaluation>\",\n    \"default\",\n);\n"],"names":[],"mappings":";;;;AAAA,uEAAuE;AACvE;;uCACe,IAAA,wQAAuB,EAClC;IAAa,MAAM,IAAI,MAAM;AAAiS,GAC9T,+DACA","ignoreList":[0]}},
    {"offset": {"line": 28, "column": 0}, "map": {"version":3,"sources":["file:///Users/bachpham/Documents/CuThongThai_Calendar/app/assets/AssetsDashboard.js/__nextjs-internal-proxy.mjs"],"sourcesContent":["// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport default registerClientReference(\n    function() { throw new Error(\"Attempted to call the default export of [project]/app/assets/AssetsDashboard.js from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/app/assets/AssetsDashboard.js\",\n    \"default\",\n);\n"],"names":[],"mappings":";;;;AAAA,uEAAuE;AACvE;;uCACe,IAAA,wQAAuB,EAClC;IAAa,MAAM,IAAI,MAAM;AAA6Q,GAC1S,2CACA","ignoreList":[0]}},
    {"offset": {"line": 42, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":""}},
    {"offset": {"line": 50, "column": 0}, "map": {"version":3,"sources":["file:///Users/bachpham/Documents/CuThongThai_Calendar/app/assets/page.js"],"sourcesContent":["import { createClient } from '@supabase/supabase-js';\nimport AssetsDashboard from './AssetsDashboard';\n\nexport const dynamic = 'force-dynamic';\n\nexport const metadata = {\n    title: 'Tài Sản & Giá Cả | Cú Thông Thái',\n    description: 'Biến động Vàng SJC, Vàng Thế Giới, Bất Động Sản và giá cả sinh hoạt (Phở Index) tại Việt Nam.',\n    openGraph: {\n        title: 'Tài Sản & Giá Cả - Theo dõi Vàng & BĐS',\n        description: 'So sánh hiệu suất đầu tư giữa Vàng, Đất và Tiền gửi qua các thời kỳ.',\n        images: ['/og-assets.png'],\n    },\n};\n\nconst supabase = createClient(\n    process.env.SUPABASE_URL,\n    process.env.SUPABASE_KEY\n);\n\n// Helper to pivot data.\nconst pivotData = (rows) => {\n    const map = {};\n    rows.forEach(r => {\n        const dateStr = r.date.split('T')[0];\n        if (!map[dateStr]) map[dateStr] = { date: dateStr };\n\n        if (r.indicator_key === 'GOLD_SJC') map[dateStr].sjc = Number(r.value);\n        if (r.indicator_key === 'GOLD_WORLD') map[dateStr].world = Number(r.value);\n\n        if (r.indicator_key === 'RE_HANOI_GOLD') map[dateStr].hn_gold = Number(r.value);\n        if (r.indicator_key === 'RE_HANOI_VND') map[dateStr].hn_vnd = Number(r.value);\n        if (r.indicator_key === 'RE_HCMC_GOLD') map[dateStr].hcm_gold = Number(r.value);\n        if (r.indicator_key === 'RE_HCMC_VND') map[dateStr].hcm_vnd = Number(r.value);\n\n        if (r.indicator_key === 'PHO_PRICE_VND') map[dateStr].pho = Number(r.value);\n\n        // Add Forex & CPI for local usage\n        // Mapped from USDVND_OFFICIAL (imported in import_history.js)\n        if (r.indicator_key === 'USDVND_OFFICIAL') map[dateStr].usd_vnd = Number(r.value);\n        if (r.indicator_key === 'VN_CPI_YOY') map[dateStr].cpi = Number(r.value);\n\n        // Lifestyle / Fun Keys\n        if (r.indicator_key === 'PRICE_IPHONE_VN') map[dateStr].iphone = Number(r.value);\n        if (r.indicator_key === 'PRICE_SH_VN') map[dateStr].sh = Number(r.value);\n        if (r.indicator_key === 'PRICE_HAO_HAO_VN') map[dateStr].haohao = Number(r.value);\n        if (r.indicator_key === 'PRICE_BIA_HOI_VN') map[dateStr].beer = Number(r.value);\n        if (r.indicator_key === 'INCOME_AVG_VN') map[dateStr].income = Number(r.value);\n        if (r.indicator_key === 'RE_CONDO_VN') map[dateStr].condo = Number(r.value);\n    });\n    return Object.values(map).sort((a, b) => new Date(a.date) - new Date(b.date));\n};\n\n\n// Helper to extract latest value\nconst getLatest = (data, key) => {\n    const valid = data.filter(d => d[key] !== undefined && d[key] !== null);\n    if (valid.length === 0) return { value: 'N/A', date: '' };\n    const last = valid[valid.length - 1];\n    return { value: last[key], date: last.date };\n};\n\n// ... (interpolateData helper remains same) ...\nconst interpolateData = (data, key) => {\n    let lastIndex = -1;\n\n    // Find first valid index\n    for (let i = 0; i < data.length; i++) {\n        if (data[i][key] !== undefined && data[i][key] !== null) {\n            lastIndex = i;\n            break;\n        }\n    }\n\n    if (lastIndex === -1) return data; // No data at all\n\n    for (let i = lastIndex + 1; i < data.length; i++) {\n        if (data[i][key] !== undefined && data[i][key] !== null) {\n            const startVal = data[lastIndex][key];\n            const endVal = data[i][key];\n            const steps = i - lastIndex;\n            const stepValue = (endVal - startVal) / steps;\n\n            for (let j = 1; j < steps; j++) {\n                data[lastIndex + j][key] = startVal + (stepValue * j);\n            }\n            lastIndex = i;\n        }\n    }\n\n    // Forward fill the rest (flat line for latest)\n    if (lastIndex < data.length - 1) {\n        const lastVal = data[lastIndex][key];\n        for (let i = lastIndex + 1; i < data.length; i++) {\n            data[i][key] = lastVal;\n        }\n    }\n\n    return data;\n};\n\nexport default async function AssetsPage() {\n    // ... (fetch logic remains same) ...\n    // Chunked fetching to bypass Supabase 1000-row limit\n    let allData = [];\n    let from = 0;\n    const CHUNK_SIZE = 1000;\n    let more = true;\n\n    // Filter string constructing\n    const filterStr = 'indicator_key.like.GOLD%,' +\n        'indicator_key.like.RE%,' +\n        'indicator_key.like.PHO%,' +\n        'indicator_key.like.PRICE%,' + // New: Fetch all PRICE_... keys\n        'indicator_key.like.INCOME%,' + // New: Fetch INCOME...\n        'indicator_key.eq.USDVND_OFFICIAL,' +\n        'indicator_key.eq.VN_CPI_YOY';\n\n    while (more) {\n        const { data: chunk, error } = await supabase\n            .from('macro_indicators')\n            .select('*')\n            .or(filterStr)\n            .order('date', { ascending: true })\n            .range(from, from + CHUNK_SIZE - 1);\n\n        if (error) {\n            console.error('Error loading assets:', error);\n            if (from === 0) return <div className=\"p-10 text-red-500\">Error loading data</div>;\n            break;\n        }\n\n        if (chunk) {\n            allData = [...allData, ...chunk];\n            if (chunk.length < CHUNK_SIZE) {\n                more = false;\n            } else {\n                from += CHUNK_SIZE;\n            }\n        } else {\n            more = false;\n        }\n    }\n\n    const rawData = allData;\n    let chartData = pivotData(rawData || []);\n\n    // 1. Calculate Converted World Gold & Prepare USD/oz\n    const usdMap = {};\n    chartData.forEach(d => {\n        if (d.usd_vnd) usdMap[d.date] = d.usd_vnd;\n    });\n\n    let lastUsd = 0;\n    chartData.forEach(d => {\n        if (d.usd_vnd) lastUsd = d.usd_vnd;\n\n        // USD/oz Raw\n        if (d.world) {\n            d.world_usd = d.world;\n        }\n\n        // Converted\n        if (d.world && (d.usd_vnd || lastUsd)) {\n            const rate = d.usd_vnd || lastUsd;\n            d.world_converted = (d.world * rate * 1.20565) / 1000000;\n        }\n\n        if (d.sjc && d.sjc > 500) {\n            d.sjc = d.sjc / 1000000;\n        }\n    });\n\n    // 2. Interpolate Phở Data & Fun Metrics (Smooth Curve)\n    // We only interpolate 'pho' key within the full chartData\n    // 2. Interpolate Data for Smooth Charts\n    chartData = interpolateData(chartData, 'pho');\n    chartData = interpolateData(chartData, 'condo');\n    chartData = interpolateData(chartData, 'income');\n    chartData = interpolateData(chartData, 'iphone');\n    chartData = interpolateData(chartData, 'sh');\n\n    // Real Estate Interpolation (Fix missing data gaps)\n    chartData = interpolateData(chartData, 'hn_vnd');\n    chartData = interpolateData(chartData, 'hcm_vnd');\n    chartData = interpolateData(chartData, 'hn_gold');\n    chartData = interpolateData(chartData, 'hcm_gold');\n\n    // Filter subsets\n    const goldData = chartData.filter(d => d.sjc || d.world_converted || d.world_usd);\n    const reData = chartData.filter(d => d.hn_vnd || d.hcm_vnd || d.hn_gold || d.hcm_gold);\n    const phoData = chartData.filter(d => d.pho || d.cpi);\n\n    // Latest Metrics calculation (removed as logic is moved to Dashboard, but fetcher still needs basic filtering?)\n    // Actually, AssetsDashboard receives the FULL 'chartData' and does its own filtering/latest logic inside.\n    // So we can clean up this file significantly.\n\n    return (\n        <AssetsDashboard data={chartData} />\n    );\n}\n"],"names":[],"mappings":"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"}}]
}