{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/bachpham/Documents/CuThongThai_Calendar/components/MacroChart.js"],"sourcesContent":["\n'use client';\n\nimport {\n    AreaChart,\n    Area,\n    XAxis,\n    YAxis,\n    CartesianGrid,\n    Tooltip,\n    ResponsiveContainer,\n    Legend\n} from 'recharts';\nimport { useState, useMemo } from 'react';\n\nconst CustomTooltip = ({ active, payload, label }) => {\n    if (active && payload && payload.length) {\n        return (\n            <div className=\"bg-slate-800 border border-slate-700 p-3 rounded shadow-xl text-xs\">\n                <p className=\"font-bold text-slate-300 mb-2\">{label}</p>\n                {payload.map((entry, index) => (\n                    <p key={index} style={{ color: entry.color }} className=\"mb-1\">\n                        {entry.name}: <span className=\"font-mono\">{entry.value.toLocaleString()}</span>\n                        {entry.unit && <span className=\"text-slate-500 ml-1\">{entry.unit}</span>}\n                    </p>\n                ))}\n            </div>\n        );\n    }\n    return null;\n};\n\nexport default function MacroChart({\n    data,\n    title,\n    dataKeys = [{ key: 'value', color: '#10b981', name: 'Giá trị' }],\n    height = 350,\n    syncId = null\n}) {\n    const [timeRange, setTimeRange] = useState('5Y');\n    const [hiddenKeys, setHiddenKeys] = useState([]);\n\n    // Filter Data by Time Range\n    const filteredData = useMemo(() => {\n        if (timeRange === 'ALL') return data;\n\n        const now = new Date();\n        const cutoff = new Date();\n\n        if (timeRange === '1Y') cutoff.setFullYear(now.getFullYear() - 1);\n        if (timeRange === '3Y') cutoff.setFullYear(now.getFullYear() - 3);\n        if (timeRange === '5Y') cutoff.setFullYear(now.getFullYear() - 5);\n        if (timeRange === '10Y') cutoff.setFullYear(now.getFullYear() - 10);\n        if (timeRange === '25Y') cutoff.setFullYear(now.getFullYear() - 25);\n\n        return data.filter(d => new Date(d.date) >= cutoff);\n    }, [data, timeRange]);\n\n    // Handle Legend Click to Toggle Series\n    const handleLegendClick = (e) => {\n        const { dataKey } = e;\n        setHiddenKeys(prev =>\n            prev.includes(dataKey)\n                ? prev.filter(k => k !== dataKey)\n                : [...prev, dataKey]\n        );\n    };\n\n    // Determine min/max for better Y-axis scaling based on VISIBLE data\n    const activeKeys = dataKeys.filter(k => !hiddenKeys.includes(k.key));\n    const allValues = filteredData\n        .flatMap(d => activeKeys.map(k => d[k.key]))\n        .filter(v => typeof v === 'number' && !isNaN(v)); // Strict number check\n\n    // Auto-scale or default\n    let minVal = 0;\n    let maxVal = 100;\n\n    if (allValues.length > 0) {\n        minVal = Math.min(...allValues);\n        maxVal = Math.max(...allValues);\n        // Add padding\n        const padding = (maxVal - minVal) * 0.05;\n        minVal = minVal - padding;\n        maxVal = maxVal + padding;\n\n        // If values are close to 0, don't go negative unnecessarily unless data is negative\n        if (Math.min(...allValues) >= 0 && minVal < 0) minVal = 0;\n    }\n\n    return (\n        <div className=\"w-full bg-slate-900/50 p-4 rounded-xl border border-slate-800\">\n            <div className=\"flex flex-wrap items-center justify-between mb-4 gap-4\">\n                {title && <h3 className=\"text-slate-400 text-sm font-semibold uppercase tracking-wider\">{title}</h3>}\n\n                {/* Time Range Selector */}\n                <div className=\"flex space-x-1 bg-slate-900 p-1 rounded-lg\">\n                    {['1Y', '3Y', '5Y', '10Y', '25Y', 'ALL'].map(range => (\n                        <button\n                            key={range}\n                            onClick={() => setTimeRange(range)}\n                            className={`px-3 py-1 text-xs font-medium rounded transition-colors ${timeRange === range\n                                ? 'bg-slate-700 text-white'\n                                : 'text-slate-500 hover:text-slate-300'\n                                }`}\n                        >\n                            {range}\n                        </button>\n                    ))}\n                </div>\n            </div>\n\n            {/* Explicit Height Container for Recharts */}\n            <div style={{ width: '100%', height: height, minHeight: height }}>\n                <ResponsiveContainer width=\"100%\" height=\"100%\">\n                    <AreaChart\n                        data={filteredData}\n                        syncId={syncId}\n                        margin={{ top: 10, right: 30, left: 0, bottom: 0 }}\n                    >\n                        <defs>\n                            {dataKeys.map((k, i) => (\n                                <linearGradient key={i} id={`color${k.key}`} x1=\"0\" y1=\"0\" x2=\"0\" y2=\"1\">\n                                    <stop offset=\"5%\" stopColor={k.color} stopOpacity={0.3} />\n                                    <stop offset=\"95%\" stopColor={k.color} stopOpacity={0} />\n                                </linearGradient>\n                            ))}\n                        </defs>\n                        <CartesianGrid strokeDasharray=\"3 3\" stroke=\"#334155\" opacity={0.5} vertical={false} />\n                        <XAxis\n                            dataKey=\"date\"\n                            stroke=\"#64748b\"\n                            tick={{ fontSize: 11 }}\n                            tickMargin={10}\n                            minTickGap={30}\n                        />\n                        <YAxis\n                            stroke=\"#64748b\"\n                            tick={{ fontSize: 11 }}\n                            domain={[minVal, maxVal]}\n                            tickFormatter={(val) => val >= 1000 ? `${(val / 1000).toFixed(0)}k` : val}\n                        />\n                        <Tooltip content={<CustomTooltip />} />\n                        <Legend\n                            wrapperStyle={{ paddingTop: '20px' }}\n                            onClick={handleLegendClick}\n                            cursor=\"pointer\"\n                        />\n\n                        {dataKeys.map((k, i) => (\n                            <Area\n                                key={i}\n                                type=\"monotone\"\n                                dataKey={k.key}\n                                stroke={k.color}\n                                name={k.name}\n                                fill={`url(#color${k.key})`}\n                                strokeWidth={2}\n                                unit={k.unit || ''}\n                                hide={hiddenKeys.includes(k.key)}\n                                animationDuration={500}\n                                connectNulls={true}\n                            />\n                        ))}\n                    </AreaChart>\n                </ResponsiveContainer>\n            </div>\n        </div>\n    );\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 339, "column": 0}, "map": {"version":3,"sources":["file:///Users/bachpham/Documents/CuThongThai_Calendar/components/MacroUpdateModal.js"],"sourcesContent":["\n'use client';\nimport { useState } from 'react';\n\nexport default function MacroUpdateModal({ isOpen, onClose, onSuccess }) {\n    const [formData, setFormData] = useState({\n        indicator_key: 'USDVND_BLACK_MARKET',\n        date: new Date().toISOString().split('T')[0],\n        value: ''\n    });\n    const [loading, setLoading] = useState(false);\n    const [msg, setMsg] = useState('');\n\n    if (!isOpen) return null;\n\n    const handleSubmit = async (e) => {\n        e.preventDefault();\n        setLoading(true);\n        setMsg('');\n\n        try {\n            const res = await fetch('/api/macro/manual-entry', {\n                method: 'POST',\n                headers: { 'Content-Type': 'application/json' },\n                body: JSON.stringify(formData)\n            });\n            const data = await res.json();\n\n            if (res.ok) {\n                setMsg('✅ Cập nhật thành công!');\n                if (onSuccess) onSuccess();\n                setTimeout(() => {\n                    setMsg('');\n                    onClose();\n                }, 1500);\n            } else {\n                setMsg(`❌ Lỗi: ${data.error}`);\n            }\n        } catch (err) {\n            setMsg('❌ Lỗi kết nối');\n        } finally {\n            setLoading(false);\n        }\n    };\n\n    return (\n        <div className=\"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/80 backdrop-blur-sm\">\n            <div className=\"bg-slate-900 border border-slate-700 rounded-2xl w-full max-w-md p-6 shadow-2xl relative\">\n                <button\n                    onClick={onClose}\n                    className=\"absolute top-4 right-4 text-slate-500 hover:text-white\"\n                >\n                    ✕\n                </button>\n\n                <h3 className=\"text-xl font-bold text-white mb-6 flex items-center gap-2\">\n                    <span className=\"bg-amber-500 w-2 h-6 rounded-full\"></span>\n                    Cập Nhật Số Liệu\n                </h3>\n\n                <form onSubmit={handleSubmit} className=\"space-y-4\">\n                    <div>\n                        <label className=\"block text-xs font-semibold text-slate-400 mb-1 uppercase\">Chỉ Số</label>\n                        <select\n                            className=\"w-full bg-slate-950 border border-slate-700 rounded px-3 py-2 text-white focus:border-amber-500 outline-none\"\n                            value={formData.indicator_key}\n                            onChange={e => setFormData({ ...formData, indicator_key: e.target.value })}\n                        >\n                            <option value=\"USDVND_BLACK_MARKET\">USD Chợ Đen (Bán)</option>\n                            <option value=\"USDVND_OFFICIAL\">USD Ngân Hàng</option>\n                            <option value=\"VN_GDP_YOY\">GDP Growth (YoY)</option>\n                            <option value=\"VN_CPI_YOY\">CPI Inflation (YoY)</option>\n                            <option value=\"VN_INTEREST_RATE\">Lãi Suất Điều Hành</option>\n                            <option value=\"VN_SAVINGS_RATE_12M\">Lãi Suất Tiết Kiệm (12T)</option>\n                        </select>\n                    </div>\n\n                    <div>\n                        <label className=\"block text-xs font-semibold text-slate-400 mb-1 uppercase\">Ngày</label>\n                        <input\n                            type=\"date\"\n                            required\n                            className=\"w-full bg-slate-950 border border-slate-700 rounded px-3 py-2 text-white focus:border-amber-500 outline-none\"\n                            value={formData.date}\n                            onChange={e => setFormData({ ...formData, date: e.target.value })}\n                        />\n                    </div>\n\n                    <div>\n                        <label className=\"block text-xs font-semibold text-slate-400 mb-1 uppercase\">Giá Trị</label>\n                        <input\n                            type=\"number\"\n                            step=\"any\"\n                            required\n                            placeholder=\"VD: 25400 hoặc 6.5\"\n                            className=\"w-full bg-slate-950 border border-slate-700 rounded px-3 py-2 text-white font-mono text-lg focus:border-amber-500 outline-none\"\n                            value={formData.value}\n                            onChange={e => setFormData({ ...formData, value: e.target.value })}\n                        />\n                    </div>\n\n                    {msg && <div className={`text-sm text-center font-bold ${msg.includes('✅') ? 'text-green-500' : 'text-red-500'}`}>{msg}</div>}\n\n                    <button\n                        type=\"submit\"\n                        disabled={loading}\n                        className=\"w-full bg-amber-500 hover:bg-amber-600 text-black font-bold py-3 rounded-lg transition-all disabled:opacity-50 mt-4\"\n                    >\n                        {loading ? 'Đang Lưu...' : 'Lưu Dữ Liệu'}\n                    </button>\n                </form>\n            </div>\n        </div>\n    );\n}\n"],"names":[],"mappings":";;;;;AAEA;;;AADA;;AAGe,SAAS,iBAAiB,EAAE,MAAM,EAAE,OAAO,EAAE,SAAS,EAAE;;IACnE,MAAM,CAAC,UAAU,YAAY,GAAG,IAAA,yKAAQ,EAAC;QACrC,eAAe;QACf,MAAM,IAAI,OAAO,WAAW,GAAG,KAAK,CAAC,IAAI,CAAC,EAAE;QAC5C,OAAO;IACX;IACA,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,yKAAQ,EAAC;IACvC,MAAM,CAAC,KAAK,OAAO,GAAG,IAAA,yKAAQ,EAAC;IAE/B,IAAI,CAAC,QAAQ,OAAO;IAEpB,MAAM,eAAe,OAAO;QACxB,EAAE,cAAc;QAChB,WAAW;QACX,OAAO;QAEP,IAAI;YACA,MAAM,MAAM,MAAM,MAAM,2BAA2B;gBAC/C,QAAQ;gBACR,SAAS;oBAAE,gBAAgB;gBAAmB;gBAC9C,MAAM,KAAK,SAAS,CAAC;YACzB;YACA,MAAM,OAAO,MAAM,IAAI,IAAI;YAE3B,IAAI,IAAI,EAAE,EAAE;gBACR,OAAO;gBACP,IAAI,WAAW;gBACf,WAAW;oBACP,OAAO;oBACP;gBACJ,GAAG;YACP,OAAO;gBACH,OAAO,CAAC,OAAO,EAAE,KAAK,KAAK,EAAE;YACjC;QACJ,EAAE,OAAO,KAAK;YACV,OAAO;QACX,SAAU;YACN,WAAW;QACf;IACJ;IAEA,qBACI,6LAAC;QAAI,WAAU;kBACX,cAAA,6LAAC;YAAI,WAAU;;8BACX,6LAAC;oBACG,SAAS;oBACT,WAAU;8BACb;;;;;;8BAID,6LAAC;oBAAG,WAAU;;sCACV,6LAAC;4BAAK,WAAU;;;;;;wBAA2C;;;;;;;8BAI/D,6LAAC;oBAAK,UAAU;oBAAc,WAAU;;sCACpC,6LAAC;;8CACG,6LAAC;oCAAM,WAAU;8CAA4D;;;;;;8CAC7E,6LAAC;oCACG,WAAU;oCACV,OAAO,SAAS,aAAa;oCAC7B,UAAU,CAAA,IAAK,YAAY;4CAAE,GAAG,QAAQ;4CAAE,eAAe,EAAE,MAAM,CAAC,KAAK;wCAAC;;sDAExE,6LAAC;4CAAO,OAAM;sDAAsB;;;;;;sDACpC,6LAAC;4CAAO,OAAM;sDAAkB;;;;;;sDAChC,6LAAC;4CAAO,OAAM;sDAAa;;;;;;sDAC3B,6LAAC;4CAAO,OAAM;sDAAa;;;;;;sDAC3B,6LAAC;4CAAO,OAAM;sDAAmB;;;;;;sDACjC,6LAAC;4CAAO,OAAM;sDAAsB;;;;;;;;;;;;;;;;;;sCAI5C,6LAAC;;8CACG,6LAAC;oCAAM,WAAU;8CAA4D;;;;;;8CAC7E,6LAAC;oCACG,MAAK;oCACL,QAAQ;oCACR,WAAU;oCACV,OAAO,SAAS,IAAI;oCACpB,UAAU,CAAA,IAAK,YAAY;4CAAE,GAAG,QAAQ;4CAAE,MAAM,EAAE,MAAM,CAAC,KAAK;wCAAC;;;;;;;;;;;;sCAIvE,6LAAC;;8CACG,6LAAC;oCAAM,WAAU;8CAA4D;;;;;;8CAC7E,6LAAC;oCACG,MAAK;oCACL,MAAK;oCACL,QAAQ;oCACR,aAAY;oCACZ,WAAU;oCACV,OAAO,SAAS,KAAK;oCACrB,UAAU,CAAA,IAAK,YAAY;4CAAE,GAAG,QAAQ;4CAAE,OAAO,EAAE,MAAM,CAAC,KAAK;wCAAC;;;;;;;;;;;;wBAIvE,qBAAO,6LAAC;4BAAI,WAAW,CAAC,8BAA8B,EAAE,IAAI,QAAQ,CAAC,OAAO,mBAAmB,gBAAgB;sCAAG;;;;;;sCAEnH,6LAAC;4BACG,MAAK;4BACL,UAAU;4BACV,WAAU;sCAET,UAAU,gBAAgB;;;;;;;;;;;;;;;;;;;;;;;AAMnD;GA9GwB;KAAA"}}]
}